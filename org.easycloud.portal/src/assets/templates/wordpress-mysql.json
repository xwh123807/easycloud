{
    "kind": "List",
    "apiVersion": "v1",
    "params": [
        {
            "name": "user",
            "description": "用户",
            "value": "gxff"
        },
        {
            "name":"system",
            "description": "系统",
            "value": "default"
        }
    ],
    "items": [
        {
            "apiVersion": "v1",
            "kind": "Service",
            "metadata": {
                "name": "mysql-{user}",
                "labels": {
                    "component": "mysql",
                    "user": "{user}",
                    "system": "{system}"
                }
            },
            "spec": {
                "ports": [
                    {
                        "port": 3306,
                        "targetPort": 3306
                    }
                ],
                "selector": {
                    "component": "mysql",
                    "user": "{user}",
                    "system": "{system}"
                }
            }
        },
        {
            "apiVersion": "extensions/v1beta1",
            "kind": "Deployment",
            "metadata": {
                "name": "mysql-{user}",
                "namespace": "default",
                "labels": {
                    "component": "mysql",
                    "user": "{user}",
                    "system": "{system}"
                }
            },
            "spec": {
                "replicas": 1,
                "template": {
                    "metadata": {
                        "labels": {
                            "component": "mysql",
                            "user": "{user}",
                            "system": "{system}"
                        }
                    },
                    "spec": {
                        "containers": [
                            {
                                "name": "mysql",
                                "image": "mysql:5.7.17",
                                "args": [
                                    "--user=mysql"
                                ],
                                "resources": {
                                    "requests": {
                                        "memory": "512Mi"
                                    },
                                    "limits": {
                                        "memory": "1Gi"
                                    }
                                },
                                "ports": [
                                    {
                                        "containerPort": 3306
                                    }
                                ],
                                "env": [
                                    {
                                        "name": "MYSQL_ROOT_PASSWORD",
                                        "value": "password"
                                    }
                                ],
                                "securityContext": {
                                    "privileged": true
                                }
                            }
                        ]
                    }
                }
            }
        },
        {
            "apiVersion": "v1",
            "kind": "Service",
            "metadata": {
                "name": "wordpress-{user}",
                "labels": {
                    "component": "wordpress",
                    "user": "{user}",
                    "system": "{system}"
                }
            },
            "spec": {
                "type":"NodePort",
                "ports": [
                    {
                        "port": 80,
                        "targetPort": 80
                    }
                ],
                "selector": {
                    "component": "wordpress",
                    "user": "{user}",
                    "system": "{system}"
                }
            }
        },
        {
            "apiVersion": "extensions/v1beta1",
            "kind": "Deployment",
            "metadata": {
                "name": "wordpress-{user}",
                "labels": {
                    "component": "wordpress",
                    "user": "{user}",
                    "system": "{system}"
                }
            },
            "spec": {
                "replicas": 1,
                "template": {
                    "metadata": {
                        "labels": {
                            "component": "wordpress",
                            "user": "{user}",
                            "system": "{system}"
                        }
                    },
                    "spec": {
                        "containers": [
                            {
                                "name": "wordpress",
                                "image": "wordpress:4.7.0-apache",
                                "ports": [
                                    {
                                        "containerPort": "80"
                                    }
                                ],
                                "resources": {
                                    "requests": {
                                        "memory": "512Mi"
                                    },
                                    "limits": {
                                        "memory": "1Gi"
                                    }
                                },
                                "env": [
                                    {
                                        "name": "WORDPRESS_DB_HOST",
                                        "value": "mysql-{user}:3306"
                                    },
                                    {
                                        "name": "WORDPRESS_DB_PASSWORD",
                                        "value": "password"
                                    }
                                ],
                                "securityContext": {
                                    "privileged": true
                                }
                            }
                        ]
                    }
                }
            }
        }
    ]
}
